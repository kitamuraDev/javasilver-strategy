---
title: "4ç« "
---

# 4 ç« 

## å®šæ•°ã®åˆæœŸåŒ–

å®šæ•°ã¯æ˜ç¤ºçš„ã«åˆæœŸåŒ–ã‚’è¡Œã‚ãªãã¦ã‚‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ã¯ãªã‚Šã¾ã›ã‚“ã€‚ãã®ä»£ã‚ã‚Šã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§åˆæœŸåŒ–ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```java showLineNumbers copy {2-3}
public class Main {
  final int num; // å®šæ•°
  Main(int init_num) { num = init_num; } // ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§åˆæœŸåŒ–
  public static void main(String[] args) {
    System.out.println(new Main(555).num);
  }
}
```

## static å¤‰æ•°

è¦ç‚¹

- ãã®ã‚¯ãƒ©ã‚¹ã§ä¸€ç®‡æ‰€ã—ã‹é ˜åŸŸã‚’æŒãŸãªã„
- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ä¸è¦ï¼ˆ`ã‚¯ãƒ©ã‚¹å.`ã§å‘¼ã³å‡ºã›ã‚‹ï¼‰
- static ãƒ¡ã‚½ãƒƒãƒ‰ã‹ã‚‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°ã‚„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã«ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ãŒå¿…è¦

```java showLineNumbers copy {5,8}
public class Main {
  public int instanceValue = 100;

  static int getInstanceValue_1() {
    return instanceValue;            // ã€ğŸ˜¡ã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
  }
  static int getInstanceValue_2() {
    return new Main().instanceValue; // ã€ğŸ˜Šã€‘
  }
  public static void main(String[] args) {
    System.out.println(getInstanceValue_2());            // 100
    System.out.println(new Main().getInstanceValue_2()); // 100ï¼ˆä¸€å¿œã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‹ã‚‰ã§ã‚‚å‘¼ã³å‡ºã›ã‚‹ï¼‰
  }
}
```

## static ã¨ãƒãƒªãƒ¢ãƒ•ã‚£ã‚ºãƒ 

static ãƒ¡ãƒ³ãƒã¯ãƒãƒªãƒ¢ãƒ•ã‚£ã‚ºãƒ ã®å½±éŸ¿ã‚’å—ã‘ã¾ã›ã‚“ã€‚`å‚ç…§å‹`ã‚’æ³¨è¦–ã™ã‚‹<br />
ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒã¯ãƒãƒªãƒ¢ãƒ•ã‚£ã‚ºãƒ ã®å½±éŸ¿ã‚’å—ã‘ã‚‹ãŸã‚æ··åŒã—ãªã„ã‚ˆã†ã«æ³¨æ„ã™ã‚‹ã€‚

```java showLineNumbers copy
public class Main {
  public static void main(String[] args) {
    Super[] obj = { new Super(), new Sub() };
    for(Super o : obj) {
      System.out.println(o.str); // å‚ç…§å‹ã¯Superã ã‹ã‚‰ã€Super ãŒå‡ºåŠ›ã•ã‚Œã‚‹
      o.say();                   // å‚ç…§å‹ã¯Superã ã‹ã‚‰ã€say super ãŒå‡ºåŠ›ã•ã‚Œã‚‹
      o.hello();                 // hello() ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ã®ãŸã‚ã€ãƒãƒªãƒ¢ãƒ•ã‚£ã‚ºãƒ ã®æŒ™å‹•ã‚’å–ã‚‹
    }
  }
}
class Super {
  static String str = "Super";
  static void say() { System.out.println("say super"); }
  void hello() { System.out.println("hello super"); }
}
class Sub extends Super {
  static String str = "Sub";
  static void say() { System.out.println("say sub"); }
  void hello() { System.out.println("hello sub"); }
}
```

## static ãƒ¡ã‚½ãƒƒãƒ‰ ã¨ this

static ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã¯`this`ã¯ä½¿ç”¨ã§ããªã„ã®ã§æ³¨æ„ãŒå¿…è¦ã€‚

```java showLineNumbers copy /this.s;/
public class Main {
  static String s;
  Main(String s) { this.s = s; }

  static String getS() { return this.s; } // ã€ğŸ˜¡ã€‘ staticãƒ¡ã‚½ãƒƒãƒ‰å†…ã§ã¯ this ã¯ä½¿ç”¨ã§ããªã„
  String getS() { return this.s; }        // ã€ğŸ˜Šã€‘
  public static void main(String[] args) {
    System.out.println(new Main("foo").getS());
  }
}
```

## ãƒ¡ãƒ³ãƒé–“ã‚¢ã‚¯ã‚»ã‚¹

è¦ç‚¹

- ã€ğŸ˜Šã€‘`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒ` -> `ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒ`
- ã€ğŸ˜Šã€‘`static ãƒ¡ãƒ³ãƒ` -> `static ãƒ¡ãƒ³ãƒ`
- ã€ğŸ˜Šã€‘`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒ` -> `static ãƒ¡ãƒ³ãƒ`
- ã€ğŸ˜¡ã€‘`static ãƒ¡ãƒ³ãƒ` -> `ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒ`ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ï¼‰
- ã€Œã‚¯ãƒ©ã‚¹å.ãƒ¡ã‚½ãƒƒãƒ‰åã€å½¢å¼ã§ã®ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
  - ã€ğŸ˜Šã€‘static ãƒ¡ãƒ³ãƒ
  - ã€ğŸ˜¡ã€‘ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ãƒ³ãƒï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ï¼‰

ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```java showLineNumbers copy
public class Main {
  static void methodA() {
    methodB();      // ã€ğŸ˜Šã€‘ staticãƒ¡ã‚½ãƒƒãƒ‰ -> staticãƒ¡ã‚½ãƒƒãƒ‰
    Main.methodB(); // ã€ğŸ˜Šã€‘ staticãƒ¡ã‚½ãƒƒãƒ‰ -> staticãƒ¡ã‚½ãƒƒãƒ‰
    methodC();      // ã€ğŸ˜¡ã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
    Main.methodD(); // ã€ğŸ˜¡ã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
  }

  static void methodB() {}

  void methodC() {
    methodB();      // ã€ğŸ˜Šã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ -> staticãƒ¡ã‚½ãƒƒãƒ‰
    Main.methodB(); // ã€ğŸ˜Šã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ -> staticãƒ¡ã‚½ãƒƒãƒ‰
    methodD();      // ã€ğŸ˜Šã€‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰ -> ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚½ãƒƒãƒ‰
    Main.methodD(); // ã€ğŸ˜¡ã€‘ ç„¡åŠ¹ãªãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ï¼ˆnew Main().methodD(); ãªã‚‰ğŸ˜Šï¼‰
  }

  void methodD() {}
}
```

## ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚¿

> Java ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã™ã‚‹ãƒ¡ãƒ¢ãƒªé ˜åŸŸã®å‰²ã‚Šå½“ã¦ã‚„è§£æ”¾ã‚’ JVM ãŒè‡ªå‹•çš„ã«è¡Œã†ã“ã¨ã€‚<br /> `ã©ã“ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œãªããªã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚¿ã®å¯¾è±¡ã«ãªã‚‹`

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å‚ç…§ã‚’å–ã‚Šé™¤ãæ–¹æ³•

- null ã‚’ä»£å…¥
- å‚ç…§å¤‰æ•°ã‚’ä»–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å‰²ã‚Šå½“ã¦ã‚‹

```java showLineNumbers copy
public class Main {
  private String ref;
  private void fnX(String s) { ref = s; };
  public void fnY() {
    String str = new String();
    fnX(str);           // 1
    str = new String(); // 2
    fnX(null);          // 3
  }
}
```

è§£èª¬

1. 5 è¡Œç›®ã®`new String();` ã¯ã€ref ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œã‚‹
2. str ã«æ–°ã—ãä½œæˆã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰²ã‚Šå½“ã¦ã€å‚ç…§å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
3. null ã‚’ ref ã«ä»£å…¥ã™ã‚‹ã“ã¨ã§ã€5 è¡Œç›®ã®`new String();` ã¯ã€ã©ã“ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œãªããªã‚‹ã€‚ã“ã“ã§ã¯ã˜ã‚ã¦ GC ã®å¯¾è±¡ã«ãªã‚‹
